{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": { "tools": ["Write", "Edit"] },
        "hooks": [{ "type": "command", "command": "./hooks/post-edit.sh" }]
      }
    ],
    "PreToolUse": [
      {
        "matcher": { "tools": ["Bash"] },
        "hooks": [{ "type": "command", "command": "./hooks/pre-apply.sh" }]
      }
    ],
    "Stop": [
      {
        "hooks": [{ "type": "command", "command": "./hooks/end-of-turn.sh" }]
      }
    ]
  },
  "permissions": {
    "allow": [
      "Read(**)",
      "Edit(**)",
      "Write(**)",
      "Bash(terraform init:*)",
      "Bash(terraform fmt:*)",
      "Bash(terraform validate:*)",
      "Bash(terraform plan:*)",
      "Bash(terraform show:*)",
      "Bash(terraform output:*)",
      "Bash(terraform state list:*)",
      "Bash(terraform state show:*)",
      "Bash(terraform providers:*)",
      "Bash(terraform graph:*)",
      "Bash(kubectl get:*)",
      "Bash(kubectl describe:*)",
      "Bash(kubectl logs:*)",
      "Bash(kubectl explain:*)",
      "Bash(kubectl diff:*)",
      "Bash(kubectl api-resources:*)",
      "Bash(kubectl config:*)",
      "Bash(kubectl version:*)",
      "Bash(helm list:*)",
      "Bash(helm status:*)",
      "Bash(helm template:*)",
      "Bash(helm show:*)",
      "Bash(helm search:*)",
      "Bash(helm diff:*)",
      "Bash(tfsec:*)",
      "Bash(checkov:*)",
      "Bash(trivy:*)",
      "Bash(infracost:*)",
      "Bash(yamllint:*)",
      "Bash(kubeval:*)",
      "Bash(kubeconform:*)",
      "Bash(git:*)",
      "Bash(gh:*)",
      "Bash(cat:*)",
      "Bash(ls:*)",
      "Bash(find:*)",
      "Bash(grep:*)",
      "Bash(head:*)",
      "Bash(tail:*)",
      "Bash(wc:*)",
      "Bash(mkdir:*)",
      "Bash(cp:*)",
      "Bash(mv:*)",
      "Bash(echo:*)"
    ],
    "deny": [
      "Bash(terraform apply:*)",
      "Bash(terraform destroy:*)",
      "Bash(terraform import:*)",
      "Bash(terraform state rm:*)",
      "Bash(terraform state mv:*)",
      "Bash(terraform state push:*)",
      "Bash(terraform state pull:*)",
      "Bash(terraform taint:*)",
      "Bash(terraform untaint:*)",
      "Bash(terraform force-unlock:*)",
      "Bash(kubectl apply:*)",
      "Bash(kubectl create:*)",
      "Bash(kubectl delete:*)",
      "Bash(kubectl patch:*)",
      "Bash(kubectl edit:*)",
      "Bash(kubectl exec:*)",
      "Bash(kubectl run:*)",
      "Bash(kubectl scale:*)",
      "Bash(kubectl rollout:*)",
      "Bash(kubectl cordon:*)",
      "Bash(kubectl drain:*)",
      "Bash(kubectl taint:*)",
      "Bash(helm install:*)",
      "Bash(helm upgrade:*)",
      "Bash(helm uninstall:*)",
      "Bash(helm delete:*)",
      "Bash(helm rollback:*)",
      "Bash(rm -rf /)",
      "Bash(rm -rf /*)",
      "Bash(rm -rf ~)",
      "Bash(chmod 777 *)",
      "Bash(curl * | bash)",
      "Bash(wget * | bash)",
      "Bash(*> /etc/*)",
      "Bash(sudo *)",
      "Bash(su *)",
      "Read(**/.tfstate)",
      "Read(**/*.tfstate)",
      "Read(**/.tfstate.*)",
      "Read(**/terraform.tfstate)",
      "Read(**/.tfvars)",
      "Read(**/*.tfvars)",
      "Read(**/secrets.tfvars)",
      "Read(**/.env)",
      "Read(**/.env.*)",
      "Read(**/secrets.*)",
      "Read(**/*credentials*)",
      "Read(**/*password*)",
      "Read(**/.aws/*)",
      "Read(**/.ssh/*)",
      "Read(**/.kube/config)",
      "Write(**/.env)",
      "Write(**/.env.*)",
      "Write(**/secrets.*)",
      "Write(**/*.tfvars)",
      "Write(**/*credentials*)",
      "Edit(**/.env)",
      "Edit(**/.env.*)",
      "Edit(**/secrets.*)",
      "Edit(**/*.tfvars)"
    ]
  }
}
